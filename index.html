<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Libro Álbum Digital Pedagógico</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Merriweather:ital,wght@0,300;0,400;0,700;1,300&family=Lato:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

    <style>
        /* --- VARIABLES & RESET (CÓDIGO ORIGINAL INTACTO) --- */
        :root {
            --book-width: 460px;
            --book-height: 600px;
            --bg-color: #eef2f3;
            --paper-texture: #fdfbf7;
            --text-color: #2c3e50;
            --accent-color: #5d4037;
            --gold-color: #d4af37;
            --endpaper-bg: #a5d6a7; 
            --endpaper-dot: #ffffff; 
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Lato', sans-serif;
            background-color: var(--bg-color);
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-color);
        }

        /* --- UI EXTERNA --- */
        .sidebar {
            position: fixed; left: 0; top: 0; bottom: 0; width: 50px;
            background: #fff; border-right: 1px solid #ddd;
            display: flex; align-items: center; justify-content: center;
            z-index: 100; box-shadow: 2px 0 10px rgba(0,0,0,0.05);
        }
        .project-title {
            writing-mode: vertical-rl; transform: rotate(180deg);
            font-family: 'Cinzel', serif; font-weight: 700; color: #888;
            letter-spacing: 3px; font-size: 12px;
        }

        .top-controls {
            position: fixed; top: 20px; right: 20px; z-index: 100;
            display: flex; gap: 10px;
        }
        .btn-icon {
            background: white; border: none; width: 35px; height: 35px;
            border-radius: 50%; cursor: pointer; color: #555;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1); transition: 0.3s;
        }
        .btn-icon:hover { color: var(--accent-color); transform: scale(1.1); }

        /* --- ESCENARIO 3D --- */
        #stage {
            perspective: 2500px;
            width: 100%; height: 100%;
            display: flex; align-items: center; justify-content: center;
            transition: transform 0.5s ease;
        }

        .book {
            position: relative;
            width: var(--book-width);
            height: var(--book-height);
            transform-style: preserve-3d;
            transition: transform 0.6s ease-in-out;
        }
        .book.opened { transform: translateX(50%); }

        /* --- HOJAS (PAPERS) --- */
        .paper {
            position: absolute; width: 100%; height: 100%; top: 0; left: 0;
            transform-origin: left center;
            transition: transform 1s cubic-bezier(0.645, 0.045, 0.355, 1);
            transform-style: preserve-3d;
        }
        .paper.flipped { transform: rotateY(-180deg); z-index: 0; }

        /* --- CARAS DE LA HOJA --- */
        .front, .back {
            position: absolute; width: 100%; height: 100%; top: 0; left: 0;
            background-color: var(--paper-texture);
            backface-visibility: hidden;
            overflow: hidden;
            border-radius: 2px 5px 5px 2px;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.05);
        }
        .front { z-index: 2; border-right: 1px solid rgba(0,0,0,0.1); }
        .back { 
            z-index: 1; transform: rotateY(180deg); 
            border-left: 1px solid rgba(0,0,0,0.1);
            border-radius: 5px 2px 2px 5px; 
        }

        /* Sombras del lomo */
        .front::after {
            content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 25px;
            background: linear-gradient(to right, rgba(0,0,0,0.2) 0%, rgba(0,0,0,0) 100%);
            pointer-events: none;
        }
        .back::after {
            content: ''; position: absolute; right: 0; top: 0; bottom: 0; width: 25px;
            background: linear-gradient(to left, rgba(0,0,0,0.2) 0%, rgba(0,0,0,0) 100%);
            pointer-events: none;
        }

        /* --- ESTILOS DE PÁGINA --- */
        .image-page {
            background-size: cover;
            background-position: center;
            background-color: #fff;
        }
        .image-page .content-wrapper { display: none; }

        .text-page {
            background-color: #fffefae6;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            padding: 60px; text-align: center;
        }
        
        .text-page h2 {
            font-family: 'Cinzel', serif; color: var(--accent-color);
            font-size: 1.4rem; margin-bottom: 25px;
            position: relative; padding-bottom: 15px;
        }
        .text-page h2::after {
            content: ''; position: absolute; bottom: 0; left: 50%; transform: translateX(-50%);
            width: 40px; height: 1px; background: var(--gold-color);
        }
        .text-page p {
            font-family: 'Merriweather', serif; font-size: 0.95rem;
            line-height: 2; color: #555; font-style: italic;
        }
        .legal-text { font-size: 0.75rem !important; color: #888 !important; font-style: normal !important; }

        .endpaper {
            background-color: var(--endpaper-bg);
            background-image: radial-gradient(var(--endpaper-dot) 1.5px, transparent 1.5px), radial-gradient(var(--endpaper-dot) 1.5px, transparent 1.5px);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
        }

        /* --- ESTILO PARA NUMERACIÓN DE PÁGINAS --- */
        .page-number {
            position: absolute;
            bottom: 20px;
            font-family: 'Cinzel', serif;
            font-size: 14px;
            color: var(--text-color);
            font-weight: bold;
            pointer-events: none;
            text-shadow: 0 1px 2px rgba(255,255,255,0.8);
            z-index: 10;
        }
        .front .page-number { right: 20px; }
        .back .page-number { left: 20px; }


        /* --- BOTONES NAVEGACIÓN --- */
        .nav-btn {
            position: fixed; top: 50%; transform: translateY(-50%);
            background: rgba(255,255,255,0.8); border: none;
            width: 50px; height: 50px; border-radius: 50%;
            cursor: pointer; z-index: 90; transition: 0.3s;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .nav-btn:hover:not(:disabled) { background: white; transform: translateY(-50%) scale(1.1); color: var(--accent-color); }
        .nav-btn:disabled { opacity: 0.3; cursor: default; }
        .prev-btn { left: 70px; }
        .next-btn { right: 70px; }

        @media (max-width: 1100px) {
            :root { --book-width: 350px; --book-height: 500px; }
            .prev-btn { left: 20px; } .next-btn { right: 20px; }
            .sidebar { display: none; }
        }

        /* ========================================================================= */
        /* --- ESTILO: SISTEMA DE ETIQUETAS PEDAGÓGICAS Y PERSONAJE --- */
        /* ========================================================================= */
        .pedagogical-layer {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none;
            z-index: 200;
            display: flex;
            justify-content: space-between;
            align-items: stretch; 
            padding: 0 5px; 
        }

        .ped-label-container {
            width: 250px;
            display: flex;
            flex-direction: column;
            /* CAMBIO: Transición más suave para cambios de posición */
            transition: padding 0.8s cubic-bezier(0.22, 1, 0.36, 1);
        }

        /* CLASES DINÁMICAS DE POSICIÓN VERTICAL (Base) */
        .align-bottom {
            justify-content: flex-end;
            /* El padding se ajustará dinámicamente en JS para la variación */
            padding-top: 0;
        }

        .align-top {
            justify-content: flex-start;
            padding-bottom: 0;
        }

        /* --- CONFIGURACIÓN DE ANIMACIONES LATERALES --- */
        
        .ped-label-left {
            margin-left: 5px; 
            text-align: right;
            align-items: flex-end;
        }

        .ped-label-right {
            margin-right: 5px; 
            text-align: left;
            align-items: flex-start;
        }

        /* Estilos base (ocultos) */
        .ped-cloud, .ped-character {
            opacity: 0;
            /* CAMBIO: Curva de animación 'Fluid' (más natural) */
            transition: all 0.8s cubic-bezier(0.22, 1, 0.36, 1);
        }

        .ped-cloud {
            background-color: #fff;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            border: 1px solid #eee;
            position: relative;
            max-width: 100%;
            margin-bottom: 10px;
        }

        .ped-character {
            width: 120px;
            height: auto;
            transition-delay: 0.1s; 
        }

        /* --- ANIMACIONES LADO IZQUIERDO: Entran desde la izquierda (-X) --- */
        .ped-label-left .ped-cloud,
        .ped-label-left .ped-character {
            transform: translateX(-150px); /* Un poco más lejos para dar más recorrido */
        }

        .ped-label-left .ped-cloud.active,
        .ped-label-left .ped-character.active {
            opacity: 1;
            transform: translateX(0); 
        }


        /* --- ANIMACIONES LADO DERECHO: Entran desde la derecha (+X) --- */
        .ped-label-right .ped-cloud {
            transform: translateX(150px); 
        }
        .ped-label-right .ped-cloud.active {
            opacity: 1;
            transform: translateX(0); 
        }

        /* Personaje Derecho (Con efecto espejo scaleX) */
        .ped-label-right .ped-character {
            transform: translateX(150px) scaleX(-1); 
        }
        .ped-label-right .ped-character.active {
            opacity: 1;
            transform: translateX(0) scaleX(-1);
        }

        /* Triangulitos de las nubes */
        .ped-label-left .ped-cloud::after {
            content: ''; position: absolute; top: 100%; right: 40px; 
            border-width: 10px 10px 0 10px; border-style: solid;
            border-color: #fff transparent transparent transparent;
        }
        .ped-label-right .ped-cloud::after {
            content: ''; position: absolute; top: 100%; left: 40px; 
            border-width: 10px 10px 0 10px; border-style: solid;
            border-color: #fff transparent transparent transparent;
        }

        .ped-cloud h3 {
            font-family: 'Cinzel', serif;
            color: var(--accent-color);
            font-size: 1rem;
            margin-bottom: 8px;
            border-bottom: 2px solid var(--gold-color);
            display: inline-block;
            padding-bottom: 3px;
        }

        .ped-cloud p {
            font-family: 'Lato', sans-serif;
            font-size: 0.85rem;
            color: #666;
            line-height: 1.5;
        }

        @media (max-width: 1300px) {
            .ped-label-container { width: 200px; }
            .ped-label-left { margin-left: 5px; }
            .ped-label-right { margin-right: 5px; }
        }
        @media (max-width: 900px) {
            .pedagogical-layer { display: none; } 
        }
    </style>
</head>
<body>

    <!-- --- CÓDIGO HTML ORIGINAL INTACTO --- -->
    <div class="sidebar">
        <div class="project-title">Libro Álbum Digital</div>
    </div>

    <div class="top-controls">
        <button class="btn-icon" onclick="toggleZoom()" title="Zoom"><i class="fas fa-search-plus"></i></button>
        <button class="btn-icon" onclick="toggleFullScreen()" title="Pantalla Completa"><i class="fas fa-expand"></i></button>
    </div>

    <button class="nav-btn prev-btn" id="prevBtn" onclick="goPrev()"><i class="fas fa-chevron-left"></i></button>

    <div id="stage">
        <div class="book" id="book">
            </div>
    </div>

    <button class="nav-btn next-btn" id="nextBtn" onclick="goNext()"><i class="fas fa-chevron-right"></i></button>

    <audio id="pageFlipSound" src="https://raw.githubusercontent.com/libroalbum/libro-lbum-pedag-gico/main/images/sonido%20deslizar.mp3" preload="auto"></audio>

    <!-- ========================================================================= -->
    <!-- --- HTML: CAPA DE ETIQUETAS Y PERSONAJE --- -->
    <!-- ========================================================================= -->
    <div class="pedagogical-layer">
        
        <!-- CONTENEDORES (Las clases de alineación se inyectarán por JS) -->
        <div id="container-left" class="ped-label-container ped-label-left">
            <div id="cloud-left" class="ped-cloud">
                <h3 id="title-left">Título</h3>
                <p id="desc-left">Descripción...</p>
            </div>
            
            <!-- *** CAMBIA AQUI EL LINK DE LA IMAGEN DEL PERSONAJE (LADO IZQUIERDO) *** -->
            <img id="char-left" class="ped-character" 
                 src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/28/Patrick_Star_character.png/330px-Patrick_Star_character.png" 
                 alt="Personaje Guía">
        </div>

        <div id="container-right" class="ped-label-container ped-label-right">
            <div id="cloud-right" class="ped-cloud">
                <h3 id="title-right">Título</h3>
                <p id="desc-right">Descripción...</p>
            </div>
            
            <!-- *** CAMBIA AQUI EL LINK DE LA IMAGEN DEL PERSONAJE (LADO DERECHO) *** -->
            <img id="char-right" class="ped-character" 
                 src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/28/Patrick_Star_character.png/330px-Patrick_Star_character.png" 
                 alt="Personaje Guía">
        </div>

    </div>

    <script>
        // --- CÓDIGO JAVASCRIPT ORIGINAL INTACTO ---
        const bookData = [
            // HOJA 1: Portada (Imagen) + Guarda Delantera
            {
                front: {
                    type: "image-page",
                    bg: "https://github.com/libroalbum/libro-lbum-pedag-gico/blob/main/images/portada%20forntal.PNG?raw=true",
                    tooltip: { title: "La Portada", text: "Es la cara del libro." }
                },
                back: {
                    type: "endpaper",
                    tooltip: { title: "Guardas Delanteras", text: "Hojas de papel decorativo." }
                }
            },
            // HOJA 2: Guarda + Hoja de Respeto
            {
                front: {
                    type: "endpaper",
                    tooltip: { title: "Guardas", text: "Transición visual." }
                },
                back: {
                    type: "text-page",
                    title: "El Susurro de las Cumbres",
                    text: "(Hoja de Respeto)",
                    tooltip: { title: "Hoja de Respeto", text: "Página de cortesía." }
                }
            },
            // HOJA 3: Créditos + Dedicatoria
            {
                front: {
                    type: "text-page",
                    title: "Créditos",
                    text: "<span class='legal-text'>Primera Edición Digital, 2024<br>Ilustraciones: Nature Collection<br>Diseño: Front-End Expert<br>ISBN: 978-0-123-45678-9<br>Todos los derechos reservados.</span>",
                    tooltip: { title: "Página Legal", text: "Créditos de edición." }
                },
                back: {
                    type: "text-page",
                    title: "Dedicatoria",
                    text: "<i>A la naturaleza,<br>que siempre cuenta las mejores historias.</i>",
                    tooltip: { title: "Dedicatoria", text: "Espacio íntimo." }
                }
            },
            // CUERPO DEL LIBRO (Imágenes)
        ];

        // Se mantiene para estructura lógica
        const landscapeImages = [
            "1470071459604-3b5ec3a7fe05", "1472214103451-9374bd1c798e", 
            "1501854140884-074cf2b29752", "1441974231531-c6227db76b6e", 
            "1426604966848-d7adac402bff", "1447752875204-b2f9798c19a3", 
            "1511497584788-876760111969", "1504198458649-3128b932f49e", 
            "1465146344425-f00d5f5c8f07", "1475924156734-496f6cac6ec1", 
            "1502082553048-f009c37129b9", "1418065460487-3e41a6c84dc5", 
            "1500964757637-c85e8a162699", "1518495973542-4542c06a5843"
        ];

        // -----------------------------------------------------------------------------------------
        // AQUI EMPIEZAN LAS HOJAS INDIVIDUALES
        // -----------------------------------------------------------------------------------------

        // --- HOJA DE CONTENIDO 1 (Cuerpo) ---
        bookData.push({
            front: {
                type: "image-page",
                bg: "https://github.com/libroalbum/libro-lbum-pedag-gico/blob/main/images/1x.png?raw=true",
                tooltip: { title: "Narrativa Visual", text: "Ilustración." }
            },
            back: {
                type: "image-page",
                bg: "https://github.com/libroalbum/libro-lbum-pedag-gico/blob/main/images/pg2.jpg?raw=true",
                tooltip: { title: "Narrativa Visual", text: "Ilustración." }
            }
        });

        // --- HOJA DE CONTENIDO  (Cuerpo) ---
        bookData.push({
            front: {
                type: "image-page",
                bg: "https://github.com/libroalbum/libro-lbum-pedag-gico/blob/main/images/pg3.jpg?raw=true",
                tooltip: { title: "Narrativa Visual", text: "Ilustración." }
            },
            back: {
                type: "image-page",
                bg: "https://github.com/libroalbum/libro-lbum-pedag-gico/blob/main/images/pg4.jpg?raw=true",
                tooltip: { title: "Narrativa Visual", text: "Ilustración." }
            }
        });

        // --- HOJA DE CONTENIDO  (Cuerpo) ---
        bookData.push({
            front: {
                type: "image-page",
                bg: "https://github.com/libroalbum/libro-lbum-pedag-gico/blob/main/images/pg%205.jpg?raw=true",
                tooltip: { title: "Narrativa Visual", text: "Ilustración." }
            },
            back: {
                type: "image-page",
                bg: "https://github.com/libroalbum/libro-lbum-pedag-gico/blob/main/images/pg%206.png?raw=true",
                tooltip: { title: "Narrativa Visual", text: "Ilustración." }
            }
        });

        // --- HOJA DE CONTENIDO  (Cuerpo) ---
        bookData.push({
            front: {
                type: "image-page",
                bg: "https://github.com/libroalbum/libro-lbum-pedag-gico/blob/main/images/pg7.png?raw=true",
                tooltip: { title: "Narrativa Visual", text: "Ilustración." }
            },
            back: {
                type: "image-page",
                bg: "https://github.com/libroalbum/libro-lbum-pedag-gico/blob/main/images/pg8.jpg?raw=true",
                tooltip: { title: "Narrativa Visual", text: "Ilustración." }
            }
        });

        // --- HOJA DE CONTENIDO  (Cuerpo) ---
        bookData.push({
            front: {
                type: "image-page",
                bg: "https://github.com/libroalbum/libro-lbum-pedag-gico/blob/main/images/pg9.png?raw=true",
                tooltip: { title: "Narrativa Visual", text: "Ilustración." }
            },
            back: {
                type: "image-page",
                bg: "https://github.com/libroalbum/libro-lbum-pedag-gico/blob/main/images/pg10.jpg?raw=true",
                tooltip: { title: "Narrativa Visual", text: "Ilustración." }
            }
        });

        // --- HOJA DE CONTENIDO  (Cuerpo) ---
        bookData.push({
            front: {
                type: "image-page",
                bg: "https://github.com/libroalbum/libro-lbum-pedag-gico/blob/main/images/pg11.jpg?raw=true",
                tooltip: { title: "Narrativa Visual", text: "Ilustración." }
            },
            back: {
                type: "image-page",
                bg: "https://github.com/libroalbum/libro-lbum-pedag-gico/blob/main/images/pg12.png?raw=true",
                tooltip: { title: "Narrativa Visual", text: "Ilustración." }
            }
        });

        // --- HOJA DE CONTENIDO  (Cuerpo) ---
        bookData.push({
            front: {
                type: "image-page",
                bg: "https://github.com/libroalbum/libro-lbum-pedag-gico/blob/main/images/pg13.jpg?raw=true",
                tooltip: { title: "Narrativa Visual", text: "Ilustración." }
            },
            back: {
                type: "image-page",
                bg: "https://github.com/libroalbum/libro-lbum-pedag-gico/blob/main/images/pg14.jpg?raw=true",
                tooltip: { title: "Narrativa Visual", text: "Ilustración." }
            }
        });

        // --- HOJA NUEVA EXTRA 1 (Cuerpo) ---
        bookData.push({
            front: {
                type: "image-page",
                bg: "https://github.com/libroalbum/libro-lbum-pedag-gico/blob/main/images/pg15.jpg?raw=true", 
                tooltip: { title: "Narrativa Visual", text: "Ilustración." }
            },
            back: {
                type: "image-page",
                bg: "https://github.com/libroalbum/libro-lbum-pedag-gico/blob/main/images/pg%2016.jpg?raw=true",
                tooltip: { title: "Narrativa Visual", text: "Ilustración." }
            }
        });

        // --- HOJA NUEVA EXTRA 2 (Cuerpo) ---
        bookData.push({
            front: {
                type: "image-page",
                bg: "https://github.com/libroalbum/libro-lbum-pedag-gico/blob/main/images/pg%2017.jpg?raw=true",
                tooltip: { title: "Narrativa Visual", text: "Ilustración." }
            },
            back: {
                type: "image-page",
                bg: "https://github.com/libroalbum/libro-lbum-pedag-gico/blob/main/images/pg13.jpg?raw=true",
                tooltip: { title: "Narrativa Visual", text: "Ilustración." }
            }
        });

        // HOJA FINAL: Guardas + Contraportada (Imagen)
        bookData.push({
            front: {
                type: "endpaper",
                tooltip: { title: "Guardas Finales", text: "Cierre físico." }
            },
            back: {
                type: "image-page",
                bg: "https://github.com/libroalbum/libro-lbum-pedag-gico/blob/main/images/contraportada.jpg?raw=true",
                tooltip: { title: "Contraportada", text: "Imagen final." }
            }
        });

        // --- RENDERIZADO ---
        const bookContainer = document.getElementById('book');
        let currentPaperIndex = -1;
        let globalPageCounter = 1; 

        bookData.forEach((sheet, index) => {
            const paper = document.createElement('div');
            paper.className = 'paper';
            paper.style.zIndex = bookData.length - index;
            paper.id = `p-${index}`;

            const frontPageNum = globalPageCounter;
            globalPageCounter++;
            const backPageNum = globalPageCounter;
            globalPageCounter++;
            const totalPages = bookData.length * 2;

            const createFace = (data, isBack, pageNum) => {
                let contentHTML = '';
                if(data.type === 'text-page') {
                    contentHTML = `<h2>${data.title || ''}</h2><p>${data.text || ''}</p>`;
                }

                const bgStyle = data.bg ? `background-image: url('${data.bg}');` : '';
                
                let pageNumberHTML = '';
                if (pageNum > 1 && pageNum < totalPages) {
                    pageNumberHTML = `<span class="page-number">${pageNum}</span>`;
                }

                return `
                <div class="${isBack ? 'back' : 'front'} ${data.type}" style="${bgStyle}">
                    <div class="content-wrapper">${contentHTML}</div>
                    ${pageNumberHTML}
                </div>`;
            };

            paper.innerHTML = createFace(sheet.front, false, frontPageNum) + createFace(sheet.back, true, backPageNum);
            bookContainer.appendChild(paper);
        });

        const papers = document.querySelectorAll('.paper');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        
        const soundEffect = document.getElementById('pageFlipSound');
        soundEffect.volume = 1.0; 

        function updateState() {
            papers.forEach((p, i) => {
                if(i <= currentPaperIndex) {
                    p.classList.add('flipped');
                    p.style.zIndex = i + 1;
                } else {
                    p.classList.remove('flipped');
                    p.style.zIndex = papers.length - i;
                }
            });

            if (currentPaperIndex >= 0 && currentPaperIndex < papers.length - 1) {
                bookContainer.classList.add('opened');
            } else {
                bookContainer.classList.remove('opened');
            }

            prevBtn.disabled = currentPaperIndex === -1;
            nextBtn.disabled = currentPaperIndex === papers.length - 1;

            updatePedagogicalLabels();
        }

        function playFlipSound() {
            soundEffect.currentTime = 0;
            var playPromise = soundEffect.play();
            if (playPromise !== undefined) {
                playPromise.then(_ => { })
                .catch(error => { console.log("Audio bloqueado: " + error); });
            }
        }

        function goNext() {
            if (currentPaperIndex < papers.length - 1) {
                playFlipSound(); 
                currentPaperIndex++;
                updateState();
            }
        }

        function goPrev() {
            if (currentPaperIndex >= 0) {
                playFlipSound(); 
                currentPaperIndex--;
                updateState();
            }
        }

        document.addEventListener('keydown', (e) => {
            if(e.key === "ArrowRight") goNext();
            if(e.key === "ArrowLeft") goPrev();
        });

        let zoom = 1;
        function toggleZoom() {
            zoom = zoom === 1 ? 1.2 : 1;
            document.getElementById('stage').style.transform = `scale(${zoom})`;
        }

        function toggleFullScreen() {
            if(!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(e=>console.log(e));
            } else {
                document.exitFullscreen();
            }
        }

        // =========================================================================
        // --- SCRIPT: LÓGICA DE NUBES Y PERSONAJES ---
        // =========================================================================
        
        function updatePedagogicalLabels() {
            const containerLeft = document.getElementById('container-left');
            const containerRight = document.getElementById('container-right');

            const cloudLeft = document.getElementById('cloud-left');
            const cloudRight = document.getElementById('cloud-right');
            const titleLeft = document.getElementById('title-left');
            const descLeft = document.getElementById('desc-left');
            const titleRight = document.getElementById('title-right');
            const descRight = document.getElementById('desc-right');
            
            const charLeft = document.getElementById('char-left');
            const charRight = document.getElementById('char-right');

            // 1. Ocultar todo (Fade out)
            cloudLeft.classList.remove('active');
            cloudRight.classList.remove('active');
            charLeft.classList.remove('active');
            charRight.classList.remove('active');

            // 2. Esperar y mostrar la info correcta (y cambiar posición)
            setTimeout(() => {
                let leftInfo = null;
                let rightInfo = null;

                // --- LÓGICA DE MOVIMIENTO ORGÁNICO (ALEATORIO) ---
                // 1. Determinar aleatoriamente si la izquierda va arriba o abajo
                // 2. Determinar aleatoriamente un "margen variable" para que no siempre sea la misma altura
                
                const isLeftUp = Math.random() > 0.5; // 50% probabilidad
                const isRightUp = !isLeftUp; // El lado derecho hace lo contrario para equilibrar

                // Altura base
                const baseHeight = "calc(50vh - 280px)"; 
                
                // Variación aleatoria entre 0px y 60px para que "floten" a distintas alturas
                const randomOffsetLeft = Math.floor(Math.random() * 60) + "px";
                const randomOffsetRight = Math.floor(Math.random() * 60) + "px";

                // Aplicar lógica Izquierda
                containerLeft.classList.remove('align-top', 'align-bottom');
                // Reset padding inline
                containerLeft.style.paddingTop = "";
                containerLeft.style.paddingBottom = "";

                if (isLeftUp) {
                    containerLeft.classList.add('align-top');
                    containerLeft.style.paddingTop = `calc(${baseHeight} + ${randomOffsetLeft})`;
                } else {
                    containerLeft.classList.add('align-bottom');
                    containerLeft.style.paddingBottom = `calc(${baseHeight} + ${randomOffsetLeft})`;
                }

                // Aplicar lógica Derecha
                containerRight.classList.remove('align-top', 'align-bottom');
                // Reset padding inline
                containerRight.style.paddingTop = "";
                containerRight.style.paddingBottom = "";

                if (isRightUp) {
                    containerRight.classList.add('align-top');
                    containerRight.style.paddingTop = `calc(${baseHeight} + ${randomOffsetRight})`;
                } else {
                    containerRight.classList.add('align-bottom');
                    containerRight.style.paddingBottom = `calc(${baseHeight} + ${randomOffsetRight})`;
                }

                // --- LOGICA DE CONTENIDO ---
                
                if (currentPaperIndex === -1) {
                    rightInfo = { title: "La Portada", text: "Es la cara del libro. En el libro álbum, la imagen es protagonista desde aquí." };
                } 
                else if (currentPaperIndex === 0) {
                    leftInfo = { title: "Guardas (Anverso)", text: "Estas son las guardas. Son las páginas que conectan la cubierta con el interior." };
                    rightInfo = { title: "Guardas (Reverso)", text: "El color o diseño de las guardas anticipa la atmósfera emocional de la historia." };
                }
                else if (currentPaperIndex === 1) {
                    leftInfo = { title: "Hoja de Respeto", text: "Página de cortesía antes del contenido. Deja respirar al lector." };
                    rightInfo = { title: "Créditos", text: "Aquí se encuentran los datos legales: autoría, editorial y derechos de autor." };
                }
                else if (currentPaperIndex === 2) {
                    leftInfo = { title: "Dedicatoria", text: "Espacio íntimo donde el autor ofrenda su trabajo a alguien especial." };
                    rightInfo = { title: "Cuerpo del Cuento", text: "Aquí comienza la narrativa visual y textual de la historia (Página 7)." };
                }
                else if (currentPaperIndex >= 3 && currentPaperIndex <= 10) {
                    leftInfo = { title: "Narrativa Visual", text: "La imagen izquierda dialoga con la derecha para construir significado." };
                    rightInfo = { title: "Secuencia", text: "La sucesión de páginas marca el ritmo de lectura y el paso del tiempo." };
                }
                else if (currentPaperIndex === 11) {
                    leftInfo = { title: "Desenlace", text: "Última página de la historia propiamente dicha." };
                    rightInfo = { title: "Guarda Final", text: "Cierra la estructura física del libro, conectando el bloque de hojas con la tapa trasera." };
                }
                else if (currentPaperIndex === 12) {
                    leftInfo = { title: "Contraportada", text: "Cierre del libro. A menudo contiene una imagen final evocadora sin revelar el final." };
                }

                // --- APLICAR TEXTOS Y ACTIVAR ---
                if (leftInfo) {
                    titleLeft.innerText = leftInfo.title;
                    descLeft.innerText = leftInfo.text;
                    cloudLeft.classList.add('active');
                    charLeft.classList.add('active');
                }
                
                if (rightInfo) {
                    titleRight.innerText = rightInfo.title;
                    descRight.innerText = rightInfo.text;
                    cloudRight.classList.add('active');
                    charRight.classList.add('active');
                }

            }, 300);
        }

        updateState();
    </script>
</body>
</html>
