<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Libro Álbum Digital Pedagógico</title>
    
    <!-- Fuentes Elegantes -->
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Merriweather:ital,wght@0,300;0,400;0,700;1,300&family=Lato:wght@400;700&display=swap" rel="stylesheet">
    <!-- Iconos -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

    <style>
        /* --- VARIABLES & RESET --- */
        :root {
            --book-width: 460px;
            --book-height: 600px;
            --bg-color: #eef2f3;
            --paper-texture: #fdfbf7;
            --text-color: #2c3e50;
            --accent-color: #5d4037;
            --gold-color: #d4af37;
            --endpaper-bg: #e8f5e9; /* Verde Pastel Fondo */
            --endpaper-dot: #a5d6a7; /* Verde Pastel Puntos */
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Lato', sans-serif;
            background-color: var(--bg-color);
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-color);
        }

        /* --- UI EXTERNA --- */
        .sidebar {
            position: fixed; left: 0; top: 0; bottom: 0; width: 50px;
            background: #fff; border-right: 1px solid #ddd;
            display: flex; align-items: center; justify-content: center;
            z-index: 100; box-shadow: 2px 0 10px rgba(0,0,0,0.05);
        }
        .project-title {
            writing-mode: vertical-rl; transform: rotate(180deg);
            font-family: 'Cinzel', serif; font-weight: 700; color: #888;
            letter-spacing: 3px; font-size: 12px;
        }

        .top-controls {
            position: fixed; top: 20px; right: 20px; z-index: 100;
            display: flex; gap: 10px;
        }
        .btn-icon {
            background: white; border: none; width: 35px; height: 35px;
            border-radius: 50%; cursor: pointer; color: #555;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1); transition: 0.3s;
        }
        .btn-icon:hover { color: var(--accent-color); transform: scale(1.1); }

        /* --- ESCENARIO 3D --- */
        #stage {
            perspective: 2500px;
            width: 100%; height: 100%;
            display: flex; align-items: center; justify-content: center;
            transition: transform 0.5s ease;
        }

        .book {
            position: relative;
            width: var(--book-width);
            height: var(--book-height);
            transform-style: preserve-3d;
            transition: transform 0.6s ease-in-out;
        }
        .book.opened { transform: translateX(50%); }

        /* --- HOJAS (PAPERS) --- */
        .paper {
            position: absolute; width: 100%; height: 100%; top: 0; left: 0;
            transform-origin: left center;
            transition: transform 1s cubic-bezier(0.645, 0.045, 0.355, 1);
            transform-style: preserve-3d;
        }
        .paper.flipped { transform: rotateY(-180deg); z-index: 0; }

        /* --- CARAS DE LA HOJA --- */
        .front, .back {
            position: absolute; width: 100%; height: 100%; top: 0; left: 0;
            background-color: var(--paper-texture);
            backface-visibility: hidden;
            overflow: hidden;
            border-radius: 2px 5px 5px 2px;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.05);
        }
        .front { z-index: 2; border-right: 1px solid rgba(0,0,0,0.1); }
        .back { 
            z-index: 1; transform: rotateY(180deg); 
            border-left: 1px solid rgba(0,0,0,0.1);
            border-radius: 5px 2px 2px 5px; 
        }

        /* Sombras del lomo */
        .front::after {
            content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 25px;
            background: linear-gradient(to right, rgba(0,0,0,0.2) 0%, rgba(0,0,0,0) 100%);
            pointer-events: none;
        }
        .back::after {
            content: ''; position: absolute; right: 0; top: 0; bottom: 0; width: 25px;
            background: linear-gradient(to left, rgba(0,0,0,0.2) 0%, rgba(0,0,0,0) 100%);
            pointer-events: none;
        }

        /* --- ESTILOS DE PÁGINA --- */

        /* 1. Imagen (Portada, Cuerpo, Contraportada) */
        .image-page {
            background-size: cover;
            background-position: center;
            background-color: #fff;
        }
        .image-page .content-wrapper { display: none; }

        /* 2. Texto (Créditos, Dedicatoria, Respeto) */
        .text-page {
            background-color: #fffefae6;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            padding: 60px; text-align: center;
        }
        
        .text-page h2 {
            font-family: 'Cinzel', serif; color: var(--accent-color);
            font-size: 1.4rem; margin-bottom: 25px;
            position: relative; padding-bottom: 15px;
        }
        .text-page h2::after {
            content: ''; position: absolute; bottom: 0; left: 50%; transform: translateX(-50%);
            width: 40px; height: 1px; background: var(--gold-color);
        }
        .text-page p {
            font-family: 'Merriweather', serif; font-size: 0.95rem;
            line-height: 2; color: #555; font-style: italic;
        }
        .legal-text { font-size: 0.75rem !important; color: #888 !important; font-style: normal !important; }

        /* 3. Guardas (Verde Pastel) */
        .endpaper {
            background-color: var(--endpaper-bg);
            background-image: radial-gradient(var(--endpaper-dot) 1.5px, transparent 1.5px), radial-gradient(var(--endpaper-dot) 1.5px, transparent 1.5px);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
        }

        /* --- ELEMENTOS PEDAGÓGICOS --- */
        .edu-hotspot {
            position: absolute; top: 20px; right: 20px;
            width: 30px; height: 30px; background: var(--gold-color);
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            color: white; cursor: pointer; z-index: 50;
            animation: pulse-gold 2s infinite;
        }
        .back .edu-hotspot { right: auto; left: 20px; }
        .edu-hotspot i { font-size: 0.9rem; }

        .edu-bubble {
            position: absolute; top: 55px; right: -10px; width: 260px;
            background: white; padding: 15px; border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            border-top: 3px solid var(--gold-color);
            opacity: 0; visibility: hidden; transform: translateY(10px);
            transition: all 0.3s ease; z-index: 60; text-align: left; pointer-events: none;
        }
        .edu-bubble::before {
            content: ''; position: absolute; top: -6px; right: 20px;
            width: 12px; height: 12px; background: white;
            transform: rotate(45deg); border-top: 3px solid var(--gold-color); border-left: 3px solid var(--gold-color);
        }
        .back .edu-bubble { right: auto; left: -10px; border-top: 3px solid var(--gold-color); }
        .back .edu-bubble::before { right: auto; left: 20px; }
        .edu-hotspot:hover + .edu-bubble { opacity: 1; visibility: visible; transform: translateY(0); }

        .edu-bubble h4 {
            font-family: 'Cinzel', serif; color: var(--accent-color);
            font-size: 0.85rem; margin-bottom: 5px; border-bottom: 1px solid #eee; padding-bottom: 5px;
        }
        .edu-bubble p {
            font-family: 'Lato', sans-serif; font-size: 0.8rem; line-height: 1.4; color: #666;
        }

        @keyframes pulse-gold {
            0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(212, 175, 55, 0.7); }
            70% { transform: scale(1); box-shadow: 0 0 0 10px rgba(212, 175, 55, 0); }
            100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(212, 175, 55, 0); }
        }

        /* --- BOTONES NAVEGACIÓN --- */
        .nav-btn {
            position: fixed; top: 50%; transform: translateY(-50%);
            background: rgba(255,255,255,0.8); border: none;
            width: 50px; height: 50px; border-radius: 50%;
            cursor: pointer; z-index: 90; transition: 0.3s;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .nav-btn:hover:not(:disabled) { background: white; transform: translateY(-50%) scale(1.1); color: var(--accent-color); }
        .nav-btn:disabled { opacity: 0.3; cursor: default; }
        .prev-btn { left: 70px; }
        .next-btn { right: 70px; }

        @media (max-width: 1100px) {
            :root { --book-width: 350px; --book-height: 500px; }
            .prev-btn { left: 20px; } .next-btn { right: 20px; }
            .sidebar { display: none; }
        }
    </style>
</head>
<body>

    <div class="sidebar">
        <div class="project-title">Libro Álbum Digital</div>
    </div>

    <div class="top-controls">
        <button class="btn-icon" onclick="toggleZoom()" title="Zoom"><i class="fas fa-search-plus"></i></button>
        <button class="btn-icon" onclick="toggleFullScreen()" title="Pantalla Completa"><i class="fas fa-expand"></i></button>
    </div>

    <button class="nav-btn prev-btn" id="prevBtn" onclick="goPrev()"><i class="fas fa-chevron-left"></i></button>

    <div id="stage">
        <div class="book" id="book">
            <!-- Contenido generado por JS -->
        </div>
    </div>

    <button class="nav-btn next-btn" id="nextBtn" onclick="goNext()"><i class="fas fa-chevron-right"></i></button>

    <!-- *** EFECTO DE SONIDO *** -->
    <!-- NOTA: Tu enlace de Pixabay es una web, no un archivo directo. He usado este sonido de 'card-slide' (deslizamiento) que es muy realista y funciona directamente. -->
    <!-- Tu enlace era: https://pixabay.com/es/sound-effects/sliding-things-off-a-table-80588/ -->
    <audio id="pageFlipSound" src="https://raw.githubusercontent.com/libroalbum/libro-lbum-pedag-gico/main/images/sonido%20deslizar.mp3" preload="auto"></audio>

    <script>
        const bookData = [
            // HOJA 1: Portada (Imagen) + Guarda Delantera
            {
                front: {
                    type: "image-page",
                    // *** AQUI ESTA LA IMAGEN DE LA PAGINA 1 (PORTADA) ***
                    bg: "https://github.com/libroalbum/libro-lbum-pedag-gico/blob/main/images/portada.jpg?raw=true",
                    tooltip: { title: "La Portada", text: "Es la cara del libro. En el libro álbum, la imagen es protagonista desde aquí." }
                },
                back: {
                    type: "endpaper",
                    tooltip: { title: "Guardas Delanteras", text: "Hojas de papel decorativo (verde pastel) que unen la tapa con el cuerpo." }
                }
            },
            // HOJA 2: Guarda + Hoja de Respeto
            {
                front: {
                    type: "endpaper",
                    tooltip: { title: "Guardas (Continuación)", text: "Transición visual suave hacia el contenido." }
                },
                back: {
                    type: "text-page",
                    title: "El Susurro de las Cumbres",
                    text: "(Hoja de Respeto)",
                    tooltip: { title: "Hoja de Respeto", text: "Página de cortesía antes del contenido. Deja respirar al lector." }
                }
            },
            // HOJA 3: Créditos + Dedicatoria
            {
                front: {
                    type: "text-page",
                    title: "Créditos",
                    text: "<span class='legal-text'>Primera Edición Digital, 2024<br>Ilustraciones: Nature Collection<br>Diseño: Front-End Expert<br>ISBN: 978-0-123-45678-9<br>Todos los derechos reservados.</span>",
                    tooltip: { title: "Página Legal", text: "Contiene el copyright y créditos de edición." }
                },
                back: {
                    type: "text-page",
                    title: "Dedicatoria",
                    text: "<i>A la naturaleza,<br>que siempre cuenta las mejores historias.</i>",
                    tooltip: { title: "Dedicatoria", text: "Espacio íntimo donde el autor ofrenda su trabajo." }
                }
            },
            // CUERPO DEL LIBRO (Imágenes)
        ];

        // Se mantiene para estructura lógica
        const landscapeImages = [
            "1470071459604-3b5ec3a7fe05", "1472214103451-9374bd1c798e", 
            "1501854140884-074cf2b29752", "1441974231531-c6227db76b6e", 
            "1426604966848-d7adac402bff", "1447752875204-b2f9798c19a3", 
            "1511497584788-876760111969", "1504198458649-3128b932f49e", 
            "1465146344425-f00d5f5c8f07", "1475924156734-496f6cac6ec1", 
            "1502082553048-f009c37129b9", "1418065460487-3e41a6c84dc5", 
            "1500964757637-c85e8a162699", "1518495973542-4542c06a5843"
        ];

        for(let i=0; i<7; i++) {
            bookData.push({
                front: {
                    type: "image-page",
                    // *** AQUI ESTAN LAS IMAGENES DEL CUERPO DEL LIBRO (LADO IZQUIERDO) ***
                    bg: "https://github.com/libroalbum/libro-lbum-pedag-gico/blob/main/images/portada.jpg?raw=true",
                    tooltip: { title: "Narrativa Visual", text: "Ilustración a página completa." }
                },
                back: {
                    type: "image-page",
                    // *** AQUI ESTAN LAS IMAGENES DEL CUERPO DEL LIBRO (LADO DERECHO) ***
                    bg: "https://github.com/libroalbum/libro-lbum-pedag-gico/blob/main/images/portada.jpg?raw=true",
                    tooltip: { title: "Narrativa Visual", text: "Ilustración a página completa." }
                }
            });
        }

        // HOJA FINAL: Guardas + Contraportada (Imagen)
        bookData.push({
            front: {
                type: "endpaper",
                tooltip: { title: "Guardas Finales", text: "Cierran la estructura física del libro." }
            },
            back: {
                type: "image-page",
                // *** AQUI ESTA LA IMAGEN FINAL (CONTRAPORTADA) ***
                bg: "https://github.com/libroalbum/libro-lbum-pedag-gico/blob/main/images/portada.jpg?raw=true",
                tooltip: { title: "Contraportada", text: "Cierre del libro. Imagen final evocadora sin texto." }
            }
        });

        // --- RENDERIZADO ---
        const bookContainer = document.getElementById('book');
        let currentPaperIndex = -1;

        bookData.forEach((sheet, index) => {
            const paper = document.createElement('div');
            paper.className = 'paper';
            paper.style.zIndex = bookData.length - index;
            paper.id = `p-${index}`;

            const createFace = (data, isBack) => {
                let contentHTML = '';
                if(data.type === 'text-page') {
                    contentHTML = `<h2>${data.title || ''}</h2><p>${data.text || ''}</p>`;
                }

                const bgStyle = data.bg ? `background-image: url('${data.bg}');` : '';

                return `
                <div class="${isBack ? 'back' : 'front'} ${data.type}" style="${bgStyle}">
                    <div class="content-wrapper">${contentHTML}</div>
                    <div class="edu-hotspot"><i class="fas fa-info"></i></div>
                    <div class="edu-bubble">
                        <h4>${data.tooltip.title}</h4>
                        <p>${data.tooltip.text}</p>
                    </div>
                </div>`;
            };

            paper.innerHTML = createFace(sheet.front, false) + createFace(sheet.back, true);
            bookContainer.appendChild(paper);
        });

        const papers = document.querySelectorAll('.paper');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        
        // Referencia al audio
        const soundEffect = document.getElementById('pageFlipSound');
        soundEffect.volume = 1.0; // Asegurar volumen al máximo

        function updateState() {
            papers.forEach((p, i) => {
                if(i <= currentPaperIndex) {
                    p.classList.add('flipped');
                    p.style.zIndex = i + 1;
                } else {
                    p.classList.remove('flipped');
                    p.style.zIndex = papers.length - i;
                }
            });

            if (currentPaperIndex >= 0 && currentPaperIndex < papers.length - 1) {
                bookContainer.classList.add('opened');
            } else {
                bookContainer.classList.remove('opened');
            }

            prevBtn.disabled = currentPaperIndex === -1;
            nextBtn.disabled = currentPaperIndex === papers.length - 1;
        }

        function playFlipSound() {
            // *** REPRODUCIR SONIDO ***
            soundEffect.currentTime = 0;
            // Promesa para manejar errores si el navegador bloquea el audio
            var playPromise = soundEffect.play();
            if (playPromise !== undefined) {
                playPromise.then(_ => {
                    // Reproducción automática iniciada
                })
                .catch(error => {
                    console.log("Audio bloqueado o no cargado: " + error);
                });
            }
        }

        function goNext() {
            if (currentPaperIndex < papers.length - 1) {
                playFlipSound(); // Sonido al avanzar
                currentPaperIndex++;
                updateState();
            }
        }

        function goPrev() {
            if (currentPaperIndex >= 0) {
                playFlipSound(); // Sonido al retroceder
                currentPaperIndex--;
                updateState();
            }
        }

        document.addEventListener('keydown', (e) => {
            if(e.key === "ArrowRight") goNext();
            if(e.key === "ArrowLeft") goPrev();
        });

        let zoom = 1;
        function toggleZoom() {
            zoom = zoom === 1 ? 1.2 : 1;
            document.getElementById('stage').style.transform = `scale(${zoom})`;
        }

        function toggleFullScreen() {
            if(!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(e=>console.log(e));
            } else {
                document.exitFullscreen();
            }
        }

        updateState();
    </script>
</body>
</html>
